#!/usr/bin/env python3
from ListaVulnerabilidades import *
from parser import *
from param import *
from progressBar import *
from report import *
from Vulnerabilidad import *

args = arguments()

html_doc = open(args.file,'r')
parser = htmlParser(html_doc)
parser.mostrarTitulo()

vulnerabilidades = ListaVulnerabilidades()


print('[+] Loading report...')
vulnerabilidadesParseadas = parser.getAllVuln()

print('[+] Translate in progres...')
Progress = ProgressBar(len(vulnerabilidadesParseadas))
Progress.mostrar()
for vulnerabilidad in vulnerabilidadesParseadas:
    vulnerabilidad.traducir(args.language)
    vulnerabilidades.agregar(vulnerabilidad,excluir=['None','Info'])
    Progress.siguiente()
    if(args.verbose):
        vulnerabilidad.mostrar()

if(args.excel):
    Report.toExcel(vulnerabilidades,args.excel,args.language)

if(args.word):
    Report.toWord(vulnerabilidades,args.word,args.language)


print('[+] Report complete')
